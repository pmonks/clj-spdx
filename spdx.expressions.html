<!DOCTYPE html PUBLIC ""
    "">

<html><head><meta charset="UTF-8" /><title>spdx.expressions documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name"></span> <span class="project-version"></span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>spdx</span></div></div></li><li class="depth-2 branch"><a href="spdx.exceptions.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>exceptions</span></div></a></li><li class="depth-2 branch current"><a href="spdx.expressions.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>expressions</span></div></a></li><li class="depth-2 branch"><a href="spdx.licenses.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>licenses</span></div></a></li><li class="depth-2"><a href="spdx.matching.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>matching</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="spdx.expressions.html#var-extract-ids"><div class="inner"><span>extract-ids</span></div></a></li><li class="depth-1"><a href="spdx.expressions.html#var-init.21"><div class="inner"><span>init!</span></div></a></li><li class="depth-1"><a href="spdx.expressions.html#var-normalise"><div class="inner"><span>normalise</span></div></a></li><li class="depth-1"><a href="spdx.expressions.html#var-parse"><div class="inner"><span>parse</span></div></a></li><li class="depth-1"><a href="spdx.expressions.html#var-parse-with-info"><div class="inner"><span>parse-with-info</span></div></a></li><li class="depth-1"><a href="spdx.expressions.html#var-unparse"><div class="inner"><span>unparse</span></div></a></li><li class="depth-1"><a href="spdx.expressions.html#var-valid.3F"><div class="inner"><span>valid?</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">spdx.expressions</h1><div class="doc"><pre class="plaintext">SPDX license expression functionality. This functionality is bespoke (it is
not provided by Spdx-Java-Library).</pre></div><div class="public anchor" id="var-extract-ids"><h3>extract-ids</h3><div class="usage"><code>(extract-ids parse-result)</code><code>(extract-ids parse-result {:keys [include-or-later?], :or {include-or-later? false}, :as opts})</code></div><div class="doc"><pre class="plaintext">Extract all SPDX ids (as a set of strings) from the given `parse-result`.

The optional `opts` map has these keys:
* include-or-later? (boolean, default false) - controls whether the output
  includes the 'or later' indicator ('+') after license ids that have that
  designation in the parse tree.</pre></div><div class="src-link"><a href="https://github.com/pmonks/clj-spdx/blob/main/src/spdx/expressions.clj#L368">view source</a></div></div><div class="public anchor" id="var-init.21"><h3>init!</h3><div class="usage"><code>(init!)</code></div><div class="doc"><pre class="plaintext">Initialises this namespace upon first call (and does nothing on subsequent
calls), returning nil. Consumers of this namespace are not required to call
this fn, as initialisation will occur implicitly anyway; it is provided to
allow explicit control of the cost of initialisation to callers who need it.</pre></div><div class="src-link"><a href="https://github.com/pmonks/clj-spdx/blob/main/src/spdx/expressions.clj#L387">view source</a></div></div><div class="public anchor" id="var-normalise"><h3>normalise</h3><div class="usage"><code>(normalise s)</code><code>(normalise s opts)</code></div><div class="doc"><pre class="plaintext">Normalises an SPDX expression, by running it through parse then unparse.
Returns nil if `s` is nil or is not a valid SPDX expression.

`opts` are as for parse</pre></div><div class="src-link"><a href="https://github.com/pmonks/clj-spdx/blob/main/src/spdx/expressions.clj#L339">view source</a></div></div><div class="public anchor" id="var-parse"><h3>parse</h3><div class="usage"><code>(parse s)</code><code>(parse s {:keys [normalise-gpl-ids? case-sensitive-conjunctions?], :or {normalise-gpl-ids? true, case-sensitive-conjunctions? false}, :as opts})</code></div><div class="doc"><pre class="plaintext">Attempt to parse `s` (a String) as an SPDX license expression, returning a
data structure representing the parse tree, or nil if it cannot be parsed.

The optional `opts` map has these keys:
* `normalise-gpl-ids?` (boolean, default true) - controls whether
  deprecated 'historical oddity' GPL family ids in the expression are
  normalised to their non-deprecated replacements as part of the parsing
  process.
* `case-sensitive-conjunctions?` (boolean, default false) - controls whether
  conjunctions in expressions (AND, OR, WITH) are case-sensitive
  (spec-compliant, but strict) or not (non-spec-compliant, lenient).

Notes:
* The parser always normalises SPDX ids to their canonical case
  e.g. aPAcHe-2.0 -&gt; Apache-2.0

* The parser always removes redundant grouping
  e.g. (((((Apache-2.0)))))) -&gt; Apache-2.0

* The parser synthesises grouping when needed to make SPDX license
  expressions' precedence rules explicit (see
  <a href="https://spdx.github.io/spdx-spec/v2.3/SPDX-license-expressions/#d45-order-of-precedence-and-parentheses)">https://spdx.github.io/spdx-spec/v2.3/SPDX-license-expressions/#d45-order-of-precedence-and-parentheses)</a>

* The default options result in parsing that is more lenient than the SPDX
  specification and is therefore not strictly spec compliant.  You can enable
  strictly compliant parsing by setting `normalise-gpl-ids?` to `false` and
  `case-sensitive-conjunctions?` to `true`.

Examples (assuming default options):

"Apache-2.0"
-&gt; {:license-id "Apache-2.0"}

"Apache-2.0+"
-&gt; {:license-id "Apache-2.0" :or-later? true}

"GPL-2.0+"
-&gt; {:license-id "GPL-2.0-or-later"}

"GPL-2.0 WITH Classpath-exception-2.0"
-&gt; {:license-id "GPL-2.0-only"
    :license-exception-id "Classpath-exception-2.0"}

"CDDL-1.1 or (GPL-2.0+ with Classpath-exception-2.0)"
-&gt; [:or
    {:license-id "CDDL-1.1"}
    {:license-id "GPL-2.0-or-later"
     :license-exception-id "Classpath-exception-2.0"}]

See SPDX Specification Annex D for more details on SPDX license expressions:
<a href="https://spdx.github.io/spdx-spec/v2.3/SPDX-license-expressions/">https://spdx.github.io/spdx-spec/v2.3/SPDX-license-expressions/</a></pre></div><div class="src-link"><a href="https://github.com/pmonks/clj-spdx/blob/main/src/spdx/expressions.clj#L243">view source</a></div></div><div class="public anchor" id="var-parse-with-info"><h3>parse-with-info</h3><div class="usage"><code>(parse-with-info s)</code><code>(parse-with-info s {:keys [normalise-gpl-ids? case-sensitive-conjunctions?], :or {normalise-gpl-ids? true, case-sensitive-conjunctions? false}})</code></div><div class="doc"><pre class="plaintext">As for parse, but returns an instaparse parse error info if parsing fails,
instead of nil. See <a href="https://github.com/Engelberg/instaparse#parse-errors">https://github.com/Engelberg/instaparse#parse-errors</a>

`opts` are as for parse</pre></div><div class="src-link"><a href="https://github.com/pmonks/clj-spdx/blob/main/src/spdx/expressions.clj#L206">view source</a></div></div><div class="public anchor" id="var-unparse"><h3>unparse</h3><div class="usage"><code>(unparse parse-result)</code></div><div class="doc"><pre class="plaintext">Turns a valid `parse-result` (i.e. obtained from `parse`) back into a
canonicalised SPDX expression (a String).  Results are undefined for invalid
parse trees.  Returns nil if `parse-result` is nil.

Canonicalisation involves:
* Converting all SPDX listed identifiers to their official case
* Upper casing all conjunctions
* Removing redundant grouping (parens)
* Adding grouping (parens) to make precedence rules explicit</pre></div><div class="src-link"><a href="https://github.com/pmonks/clj-spdx/blob/main/src/spdx/expressions.clj#L323">view source</a></div></div><div class="public anchor" id="var-valid.3F"><h3>valid?</h3><div class="usage"><code>(valid? s)</code><code>(valid? s {:keys [case-sensitive-conjunctions?], :or {case-sensitive-conjunctions? false}})</code></div><div class="doc"><pre class="plaintext">Is `s` (a String) a valid SPDX license expression?

Note: if you intend to parse `s` if it's valid, it's more efficient to call
parse directly and check for a nil result instead of calling this method
first (it avoids double parsing).

The optional `opts` map has these keys:
* `case-sensitive-conjunctions?` (boolean, default false) - controls whether
  conjunctions in expressions (AND, OR, WITH) are case-sensitive
  (spec-compliant, but strict) or not (non-spec-compliant, lenient).</pre></div><div class="src-link"><a href="https://github.com/pmonks/clj-spdx/blob/main/src/spdx/expressions.clj#L350">view source</a></div></div></div></body></html>